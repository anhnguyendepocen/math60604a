<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>2.1 One-sample and paired t-test | Statistical Modelling</title>
  <meta name="description" content="This is a web complement to MATH 60604A (Statistical Modelling), a course given in the M.Sc. in management (Data Science and Business Analytics) at HEC Montréal." />
  <meta name="generator" content="bookdown 0.19 and GitBook 2.6.7" />

  <meta property="og:title" content="2.1 One-sample and paired t-test | Statistical Modelling" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a web complement to MATH 60604A (Statistical Modelling), a course given in the M.Sc. in management (Data Science and Business Analytics) at HEC Montréal." />
  <meta name="github-repo" content="lbelzile/math60604a" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2.1 One-sample and paired t-test | Statistical Modelling" />
  
  <meta name="twitter:description" content="This is a web complement to MATH 60604A (Statistical Modelling), a course given in the M.Sc. in management (Data Science and Business Analytics) at HEC Montréal." />
  

<meta name="author" content="Léo Belzile" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="one-sample-and-two-sample-location-tests.html"/>
<link rel="next" href="two-sample-t-test.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Statistical-modelling</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preliminary remarks</a><ul>
<li class="chapter" data-level="0.1" data-path="basics-of-r.html"><a href="basics-of-r.html"><i class="fa fa-check"></i><b>0.1</b> Basics of <strong>R</strong></a><ul>
<li class="chapter" data-level="0.1.1" data-path="basics-of-r.html"><a href="basics-of-r.html#help"><i class="fa fa-check"></i><b>0.1.1</b> Help</a></li>
<li class="chapter" data-level="0.1.2" data-path="basics-of-r.html"><a href="basics-of-r.html#basic-commands"><i class="fa fa-check"></i><b>0.1.2</b> Basic commands</a></li>
<li class="chapter" data-level="0.1.3" data-path="basics-of-r.html"><a href="basics-of-r.html#linear-algebra-in-r"><i class="fa fa-check"></i><b>0.1.3</b> Linear algebra in <strong>R</strong></a></li>
<li class="chapter" data-level="0.1.4" data-path="basics-of-r.html"><a href="basics-of-r.html#packages"><i class="fa fa-check"></i><b>0.1.4</b> Packages</a></li>
</ul></li>
<li class="chapter" data-level="0.2" data-path="week1.html"><a href="week1.html"><i class="fa fa-check"></i><b>0.2</b> Tutorial 1</a><ul>
<li class="chapter" data-level="0.2.1" data-path="week1.html"><a href="week1.html#datasets"><i class="fa fa-check"></i><b>0.2.1</b> Datasets</a></li>
<li class="chapter" data-level="0.2.2" data-path="week1.html"><a href="week1.html#graphics"><i class="fa fa-check"></i><b>0.2.2</b> Graphics</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="statistical-inference-versus-predictions.html"><a href="statistical-inference-versus-predictions.html"><i class="fa fa-check"></i><b>1.1</b> Statistical inference versus predictions</a></li>
<li class="chapter" data-level="1.2" data-path="reminders-and-objectives.html"><a href="reminders-and-objectives.html"><i class="fa fa-check"></i><b>1.2</b> Reminders and Objectives</a></li>
<li class="chapter" data-level="1.3" data-path="population-and-sample.html"><a href="population-and-sample.html"><i class="fa fa-check"></i><b>1.3</b> Population and sample</a></li>
<li class="chapter" data-level="1.4" data-path="testing-statistical-hypotheses.html"><a href="testing-statistical-hypotheses.html"><i class="fa fa-check"></i><b>1.4</b> Testing statistical hypotheses</a></li>
<li class="chapter" data-level="1.5" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html"><i class="fa fa-check"></i><b>1.5</b> Exploratory data analysis</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="one-sample-and-two-sample-location-tests.html"><a href="one-sample-and-two-sample-location-tests.html"><i class="fa fa-check"></i><b>2</b> One-sample and two-sample location tests</a><ul>
<li class="chapter" data-level="2.1" data-path="one-sample-and-paired-t-test.html"><a href="one-sample-and-paired-t-test.html"><i class="fa fa-check"></i><b>2.1</b> One-sample and paired <em>t</em>-test</a></li>
<li class="chapter" data-level="2.2" data-path="two-sample-t-test.html"><a href="two-sample-t-test.html"><i class="fa fa-check"></i><b>2.2</b> Two-sample <em>t</em>-test</a></li>
<li class="chapter" data-level="2.3" data-path="wilcoxon-rank-sum-test.html"><a href="wilcoxon-rank-sum-test.html"><i class="fa fa-check"></i><b>2.3</b> Wilcoxon rank sum test</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="linear-regression.html"><a href="linear-regression.html"><i class="fa fa-check"></i><b>3</b> Linear regression</a><ul>
<li class="chapter" data-level="3.1" data-path="the-lm-function.html"><a href="the-lm-function.html"><i class="fa fa-check"></i><b>3.1</b> The <code>lm</code> function</a><ul>
<li class="chapter" data-level="3.1.1" data-path="the-lm-function.html"><a href="the-lm-function.html#graphical-diagnostics-and-analysis-of-residuals"><i class="fa fa-check"></i><b>3.1.1</b> Graphical diagnostics and analysis of residuals</a></li>
<li class="chapter" data-level="3.1.2" data-path="the-lm-function.html"><a href="the-lm-function.html#binary-explanatory-variable"><i class="fa fa-check"></i><b>3.1.2</b> Binary explanatory variable</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Statistical Modelling</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="one-sample-and-paired-t-test" class="section level2">
<h2><span class="header-section-number">2.1</span> One-sample and paired <em>t</em>-test</h2>
<p>We covered this example of Tech3Lab comparing the reaction time between individuals for two tasks, texting and speaking on the phone, while walking. The response variable is reaction time in seconds to the presence of a bicycle moving towards the participant.</p>
<p>The data can be found in <code>distraction.txt</code> and can be loaded in <strong>R</strong> in a <code>data.frame</code> object.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="one-sample-and-paired-t-test.html#cb7-1"></a><span class="co"># get URL of the file</span></span>
<span id="cb7-2"><a href="one-sample-and-paired-t-test.html#cb7-2"></a>url &lt;-<span class="st"> &quot;https://lbelzile.bitbucket.io/MATH60619A/distraction.txt&quot;</span></span>
<span id="cb7-3"><a href="one-sample-and-paired-t-test.html#cb7-3"></a><span class="co"># load data, stating header</span></span>
<span id="cb7-4"><a href="one-sample-and-paired-t-test.html#cb7-4"></a>data &lt;-<span class="st"> </span><span class="kw">read.table</span>(url, <span class="dt">header =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<p>The columns of a <code>data.frame</code> object can be accessed using the <code>$</code> operator.</p>
<p>We can calculate descriptive statistics for the data by using the commands <code>summary</code>, or <code>mean</code>, <code>sd</code>, etc.</p>
<p>Our goal is to compare the average reaction time for texting <code>t</code> and for call <code>c</code>, say <span class="math inline">\(\mu_C=\mu_T\)</span>. Since the individuals complete the two assignments (the order is random), we are looking at a paired <span class="math inline">\(t\)</span>-test, which amounts to comparing the null <span class="math inline">\(\mathscr{H}_0: \mu_D=0\)</span>, where <span class="math inline">\(\mu_D\)</span> is the difference (in seconds) between the reaction time for texting vs phone conversation in the population. We can assess this graphically through an histogram of the distribution.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="one-sample-and-paired-t-test.html#cb8-1"></a><span class="co"># create new vector as difference in time</span></span>
<span id="cb8-2"><a href="one-sample-and-paired-t-test.html#cb8-2"></a>D &lt;-<span class="st"> </span>data<span class="op">$</span>t <span class="op">-</span><span class="st"> </span>data<span class="op">$</span>c</span>
<span id="cb8-3"><a href="one-sample-and-paired-t-test.html#cb8-3"></a><span class="co"># histogram, on the probability scale</span></span>
<span id="cb8-4"><a href="one-sample-and-paired-t-test.html#cb8-4"></a><span class="kw">hist</span>(D, <span class="dt">probability =</span> <span class="ot">TRUE</span>, </span>
<span id="cb8-5"><a href="one-sample-and-paired-t-test.html#cb8-5"></a>     <span class="dt">xlab =</span> <span class="st">&quot;Time difference between reaction time</span></span>
<span id="cb8-6"><a href="one-sample-and-paired-t-test.html#cb8-6"></a><span class="st">         for texting and call (in seconds)&quot;</span>,</span>
<span id="cb8-7"><a href="one-sample-and-paired-t-test.html#cb8-7"></a>     <span class="dt">main =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb8-8"><a href="one-sample-and-paired-t-test.html#cb8-8"></a><span class="co"># add density estimate</span></span>
<span id="cb8-9"><a href="one-sample-and-paired-t-test.html#cb8-9"></a><span class="kw">lines</span>(<span class="kw">density</span>(D))</span></code></pre></div>
<p><img src="Statistical-modelling_files/figure-html/hist_distract-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>The two sample mean (standard error) are different, 1.39 (0.53) seconds for texting and 1.08 (0.4) seconds for call. To check if this is really the case, we perform a paired <span class="math inline">\(t\)</span>-test.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="one-sample-and-paired-t-test.html#cb9-1"></a>ttest &lt;-<span class="st"> </span><span class="kw">t.test</span>(<span class="dt">x =</span> data<span class="op">$</span>t, <span class="dt">y =</span> data<span class="op">$</span>c, </span>
<span id="cb9-2"><a href="one-sample-and-paired-t-test.html#cb9-2"></a>                <span class="dt">alternative =</span> <span class="st">&quot;two.sided&quot;</span>, <span class="dt">paired =</span> <span class="ot">TRUE</span>)</span>
<span id="cb9-3"><a href="one-sample-and-paired-t-test.html#cb9-3"></a><span class="kw">print</span>(ttest)</span></code></pre></div>
<pre><code>## 
##  Paired t-test
## 
## data:  data$t and data$c
## t = 3, df = 34, p-value = 0.006
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  0.094 0.532
## sample estimates:
## mean of the differences 
##                    0.31</code></pre>
<p>The output provides the value of the test statistic <span class="math inline">\(t = \overline{D}/\mathsf{se}(\overline{D})=\)</span> 2.91 with associated <span class="math inline">\(p\)</span>-value . We strongly reject the null hypothesis that <span class="math inline">\(\mu_C=\mu_D\)</span> at level 5% (even 1%), meaning that the reaction time is significantly longer on average for texting with an estimated 95% confidence of <span class="math inline">\([\)</span> 0.09, 0.53 <span class="math inline">\(]\)</span>.</p>
<p>The null distribution of the test statistic is <span class="math inline">\(\mathcal{T}_{34}\)</span>, so we can look at how extreme our test statistic is relative to a typical value from the null distribution.</p>
<p><img src="Statistical-modelling_files/figure-html/tdensity-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>We can also do a one-sample <span class="math inline">\(t\)</span>-test using the same function. The <code>hours</code> dataset consists of a sample of size <span class="math inline">\(n=100\)</span> of workers who had attained at least a college degree. We could test whether the participants work 40 hours a week (two sided alternative), or if they work more than that. In the latter case, the null hypothesis is thus <span class="math inline">\(\mathscr{H}_0: \mu \geq 40\)</span>, where <span class="math inline">\(\mu\)</span> is the average number of weekly work hours, against the alternative <span class="math inline">\(\mathscr{H}_1: \mu &lt; 40\)</span>.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="one-sample-and-paired-t-test.html#cb11-1"></a>url &lt;-<span class="st"> &quot;https://lbelzile.bitbucket.io/MATH60619A/hours.txt&quot;</span></span>
<span id="cb11-2"><a href="one-sample-and-paired-t-test.html#cb11-2"></a>data &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="dt">file =</span> url, <span class="dt">header =</span> <span class="ot">TRUE</span>)</span>
<span id="cb11-3"><a href="one-sample-and-paired-t-test.html#cb11-3"></a>ttest_twosided &lt;-<span class="st"> </span><span class="kw">t.test</span>(data, <span class="dt">alternative =</span> <span class="st">&quot;two.sided&quot;</span>, <span class="dt">mu =</span> <span class="dv">40</span>)</span>
<span id="cb11-4"><a href="one-sample-and-paired-t-test.html#cb11-4"></a>ttest_onesided &lt;-<span class="st"> </span><span class="kw">t.test</span>(data, <span class="dt">alternative =</span> <span class="st">&quot;greater&quot;</span>, <span class="dt">mu =</span> <span class="dv">40</span>)</span></code></pre></div>
<p>In both cases, we reject the null hypothesis at level 5%, but the one-sided alternative has a smaller <span class="math inline">\(p\)</span>-value. Think about why it does not make sense to test for <span class="math inline">\(\mathscr{H}_0: \mu \leq 40\)</span> versus <span class="math inline">\(\mathscr{H}_1: \mu &gt;40\)</span> in view of the sample mean.</p>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="one-sample-and-two-sample-location-tests.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="two-sample-t-test.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Statistical modelling.pdf", "Statistical modelling.epub"],
"toc": {
"collapse": "none"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
