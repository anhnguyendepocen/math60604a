<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>2.2 Two-sample t-test | Statistical Modelling</title>
  <meta name="description" content="This is a web complement to MATH 60604A (Statistical Modelling), a course given in the M.Sc. in management (Data Science and Business Analytics) at HEC Montréal." />
  <meta name="generator" content="bookdown 0.19 and GitBook 2.6.7" />

  <meta property="og:title" content="2.2 Two-sample t-test | Statistical Modelling" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a web complement to MATH 60604A (Statistical Modelling), a course given in the M.Sc. in management (Data Science and Business Analytics) at HEC Montréal." />
  <meta name="github-repo" content="lbelzile/math60604a" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2.2 Two-sample t-test | Statistical Modelling" />
  
  <meta name="twitter:description" content="This is a web complement to MATH 60604A (Statistical Modelling), a course given in the M.Sc. in management (Data Science and Business Analytics) at HEC Montréal." />
  

<meta name="author" content="Léo Belzile" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="one-sample-and-paired-t-test.html"/>
<link rel="next" href="wilcoxon-rank-sum-test.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Statistical-modelling</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preliminary remarks</a><ul>
<li class="chapter" data-level="0.1" data-path="basics-of-r.html"><a href="basics-of-r.html"><i class="fa fa-check"></i><b>0.1</b> Basics of <strong>R</strong></a><ul>
<li class="chapter" data-level="0.1.1" data-path="basics-of-r.html"><a href="basics-of-r.html#help"><i class="fa fa-check"></i><b>0.1.1</b> Help</a></li>
<li class="chapter" data-level="0.1.2" data-path="basics-of-r.html"><a href="basics-of-r.html#basic-commands"><i class="fa fa-check"></i><b>0.1.2</b> Basic commands</a></li>
<li class="chapter" data-level="0.1.3" data-path="basics-of-r.html"><a href="basics-of-r.html#linear-algebra-in-r"><i class="fa fa-check"></i><b>0.1.3</b> Linear algebra in <strong>R</strong></a></li>
<li class="chapter" data-level="0.1.4" data-path="basics-of-r.html"><a href="basics-of-r.html#packages"><i class="fa fa-check"></i><b>0.1.4</b> Packages</a></li>
</ul></li>
<li class="chapter" data-level="0.2" data-path="week1.html"><a href="week1.html"><i class="fa fa-check"></i><b>0.2</b> Tutorial 1</a><ul>
<li class="chapter" data-level="0.2.1" data-path="week1.html"><a href="week1.html#datasets"><i class="fa fa-check"></i><b>0.2.1</b> Datasets</a></li>
<li class="chapter" data-level="0.2.2" data-path="week1.html"><a href="week1.html#graphics"><i class="fa fa-check"></i><b>0.2.2</b> Graphics</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="statistical-inference-versus-predictions.html"><a href="statistical-inference-versus-predictions.html"><i class="fa fa-check"></i><b>1.1</b> Statistical inference versus predictions</a></li>
<li class="chapter" data-level="1.2" data-path="reminders-and-objectives.html"><a href="reminders-and-objectives.html"><i class="fa fa-check"></i><b>1.2</b> Reminders and Objectives</a></li>
<li class="chapter" data-level="1.3" data-path="population-and-sample.html"><a href="population-and-sample.html"><i class="fa fa-check"></i><b>1.3</b> Population and sample</a></li>
<li class="chapter" data-level="1.4" data-path="testing-statistical-hypotheses.html"><a href="testing-statistical-hypotheses.html"><i class="fa fa-check"></i><b>1.4</b> Testing statistical hypotheses</a></li>
<li class="chapter" data-level="1.5" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html"><i class="fa fa-check"></i><b>1.5</b> Exploratory data analysis</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="one-sample-and-two-sample-location-tests.html"><a href="one-sample-and-two-sample-location-tests.html"><i class="fa fa-check"></i><b>2</b> One-sample and two-sample location tests</a><ul>
<li class="chapter" data-level="2.1" data-path="one-sample-and-paired-t-test.html"><a href="one-sample-and-paired-t-test.html"><i class="fa fa-check"></i><b>2.1</b> One-sample and paired <em>t</em>-test</a></li>
<li class="chapter" data-level="2.2" data-path="two-sample-t-test.html"><a href="two-sample-t-test.html"><i class="fa fa-check"></i><b>2.2</b> Two-sample <em>t</em>-test</a></li>
<li class="chapter" data-level="2.3" data-path="wilcoxon-rank-sum-test.html"><a href="wilcoxon-rank-sum-test.html"><i class="fa fa-check"></i><b>2.3</b> Wilcoxon rank sum test</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="linear-regression.html"><a href="linear-regression.html"><i class="fa fa-check"></i><b>3</b> Linear regression</a><ul>
<li class="chapter" data-level="3.1" data-path="the-lm-function.html"><a href="the-lm-function.html"><i class="fa fa-check"></i><b>3.1</b> The <code>lm</code> function</a><ul>
<li class="chapter" data-level="3.1.1" data-path="the-lm-function.html"><a href="the-lm-function.html#graphical-diagnostics-and-analysis-of-residuals"><i class="fa fa-check"></i><b>3.1.1</b> Graphical diagnostics and analysis of residuals</a></li>
<li class="chapter" data-level="3.1.2" data-path="the-lm-function.html"><a href="the-lm-function.html#binary-explanatory-variable"><i class="fa fa-check"></i><b>3.1.2</b> Binary explanatory variable</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Statistical Modelling</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="two-sample-t-test" class="section level2">
<h2><span class="header-section-number">2.2</span> Two-sample <em>t</em>-test</h2>
<p>We use the same example covered in slides for the <code>tickets</code> data. Since the research question is “Does paying by credit card encourage consumers to pay more?”, this calls for a one sided test, with <span class="math inline">\(\mathscr{H}_1: \mu_{\text{cred}} &gt; \mu_{\text{cash}}\)</span> and <em>de facto</em> the null hypothesis must be <span class="math inline">\(\mathscr{H}_0: \mu_{\text{cred}} \leq \mu_{\text{cash}}\)</span>. The alternative hypothesis is the one we <em>would</em> be interested in checking, but because we are the Devil’s advocate, the null hypothesis is the opposite and includes all other possibilities. Note that we only need to consider the case <span class="math inline">\(\mu_{\text{cred}} = \mu_{\text{cash}}\)</span> (why?), so one often write this as the null hypothesis.</p>
<p>We can start by loading the data and preliminary visual inspection. In light of the boxplot, it seems that the variance in the two groups differs.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="two-sample-t-test.html#cb12-1"></a>url &lt;-<span class="st"> &quot;https://lbelzile.bitbucket.io/MATH60619A/tickets.txt&quot;</span></span>
<span id="cb12-2"><a href="two-sample-t-test.html#cb12-2"></a>tickets &lt;-<span class="st"> </span><span class="kw">read.table</span>(url, <span class="dt">header =</span> <span class="ot">TRUE</span>) <span class="co">#load data</span></span>
<span id="cb12-3"><a href="two-sample-t-test.html#cb12-3"></a><span class="kw">head</span>(tickets) <span class="co">#print first six lines</span></span></code></pre></div>
<pre><code>##   offer group
## 1    62  cash
## 2    44  cash
## 3    46  cash
## 4    48  cash
## 5    50  cash
## 6    58  cash</code></pre>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="two-sample-t-test.html#cb14-1"></a><span class="kw">boxplot</span>(offer <span class="op">~</span><span class="st"> </span>group, <span class="dt">data =</span> tickets)</span></code></pre></div>
<p><img src="Statistical-modelling_files/figure-html/loadtickets-1.png" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="two-sample-t-test.html#cb15-1"></a>tickets<span class="op">$</span>group &lt;-<span class="st"> </span><span class="kw">factor</span>(<span class="dt">x =</span> tickets<span class="op">$</span>group, <span class="co">#cast binary to categ</span></span>
<span id="cb15-2"><a href="two-sample-t-test.html#cb15-2"></a>                        <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;cash&quot;</span>,<span class="st">&quot;credit&quot;</span>)) <span class="co">#assign meaningful </span></span>
<span id="cb15-3"><a href="two-sample-t-test.html#cb15-3"></a><span class="co"># summarize data by group (equivalent of PROC MEANS in SAS)</span></span>
<span id="cb15-4"><a href="two-sample-t-test.html#cb15-4"></a><span class="kw">with</span>(<span class="dt">data =</span> tickets, <span class="co">#use data</span></span>
<span id="cb15-5"><a href="two-sample-t-test.html#cb15-5"></a>     <span class="dt">expr =</span> <span class="kw">by</span>(<span class="dt">data =</span> offer, <span class="dt">FUN =</span> summary, <span class="dt">INDICES =</span> group))</span></code></pre></div>
<pre><code>## group: cash
##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##      42      52      56      57      62      74 
## ------------------------------------------------------------ 
## group: credit
##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##      34      55      70      72      85     144</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="two-sample-t-test.html#cb17-1"></a><span class="kw">with</span>(<span class="dt">data =</span> tickets, </span>
<span id="cb17-2"><a href="two-sample-t-test.html#cb17-2"></a>     <span class="dt">expr =</span> <span class="kw">by</span>(<span class="dt">data =</span> offer, <span class="dt">FUN =</span> sd, <span class="dt">INDICES =</span> group))</span></code></pre></div>
<pre><code>## group: cash
## [1] 7.5
## ------------------------------------------------------------ 
## group: credit
## [1] 24</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="two-sample-t-test.html#cb19-1"></a><span class="co"># alternatively</span></span>
<span id="cb19-2"><a href="two-sample-t-test.html#cb19-2"></a><span class="co"># sd(tickets$offer[tickets$group == &quot;cash&quot;])</span></span></code></pre></div>
<p>The option <code>header = TRUE</code> specifies that the first line of the file contains the name of the variables. While <code>read.table</code> is the default for command to read tables (with options <code>sep</code> for the separator, we will also encounter <code>read.csv</code> for comma-separated values. The data is stored in a <code>data.frame</code> object. The command <code>str</code> gives a description of the observations (with the type) and <code>head</code> prints the first lines. Other relevant commands include <code>ndim</code>, <code>nrow</code> and <code>ncol</code> that give the dimensions of the data, the number of rows and the number of columns, respectively.</p>
<p>Reference to the columns of a data frame is made using their column names (<code>colnames(tickets)</code>) using <code>$</code>, so <code>tickets$group</code> returns the second column with the binary variable. Alternatively, we can use the <code>attach</code> command to attach the dataset, in which case the variables are now accessible directly. Beware with this, as there is a risk of having multiple objects with the same name. A good practice is to <code>detach</code> the dataset after use.</p>
<p>When we load a dataset, the default option for strings is to cast them to factor (i.e., categorical variables). We do this likewise for the binary variables, even if in this case this makes no difference (but it is good practice).</p>
<p>Summary statistics showed that the mean amount offered for tickets is 56.61 (7.5) for the group paying by cash and 71.61 (23.6), but we need to perform a test in order to know whether such a difference, -15.01, is significative. Since our null hypothesis is that customers are willing to pay more by credit card, we perform a one-sided <span class="math inline">\(t\)</span>-test.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="two-sample-t-test.html#cb20-1"></a>ttest &lt;-<span class="st"> </span><span class="kw">t.test</span>(<span class="dt">formula =</span> offer <span class="op">~</span><span class="st"> </span>group, </span>
<span id="cb20-2"><a href="two-sample-t-test.html#cb20-2"></a>       <span class="dt">data =</span> tickets, </span>
<span id="cb20-3"><a href="two-sample-t-test.html#cb20-3"></a>       <span class="dt">alternative =</span> <span class="st">&quot;less&quot;</span>, <span class="co">#one-sided</span></span>
<span id="cb20-4"><a href="two-sample-t-test.html#cb20-4"></a>       <span class="dt">var.equal =</span> <span class="ot">TRUE</span>) <span class="co">#by default FALSE</span></span>
<span id="cb20-5"><a href="two-sample-t-test.html#cb20-5"></a><span class="kw">print</span>(ttest)</span></code></pre></div>
<pre><code>## 
##  Two Sample t-test
## 
## data:  offer by group
## t = -3, df = 62, p-value = 0.0005
## alternative hypothesis: true difference in means is less than 0
## 95 percent confidence interval:
##  -Inf -7.8
## sample estimates:
##   mean in group cash mean in group credit 
##                   57                   72</code></pre>
<p>In <strong>R</strong>, the default option for the function <code>t.test</code> is Welch’s test (<code>var.equal = FALSE</code>), since the latter is valid whether or not the variance of the two groups are equal. The value of the test statistic is -3.48, which should follow a Student <span class="math inline">\(t\)</span> distribution under <span class="math inline">\(H_0\)</span> with degrees of freedom, leading to a <span class="math inline">\(p\)</span>-value smaller than <span class="math inline">\(10 \times 10^{-3}\)</span>. We reject the null at level <span class="math inline">\(\alpha=0.05\)</span> in favor of the alternative that people paying by credit card are willing to spend more than those paying by cash with the lower bound of the 95% confidence interval for this difference being -7.8.</p>
<p>The equality test for the variance is not calculated directly by <code>t.test</code> in <strong>R</strong>, but the function <code>var.test</code> implements an <span class="math inline">\(F\)</span> test for this hypothesis (Levene’s test is in <code>car::leveneTest</code>). We have overwhelming evidence that the variance for the two groups are unequal, so we can should Welch’s test rather that the two-sample <span class="math inline">\(t\)</span>-test. The conclusions are the same in this case, namely that such a difference is implausible if the true average were equal.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="two-sample-t-test.html#cb22-1"></a><span class="kw">var.test</span>(<span class="dt">formula =</span> offer <span class="op">~</span><span class="st"> </span>group, </span>
<span id="cb22-2"><a href="two-sample-t-test.html#cb22-2"></a>       <span class="dt">data =</span> tickets)</span></code></pre></div>
<pre><code>## 
##  F test to compare two variances
## 
## data:  offer by group
## F = 0.1, num df = 32, denom df = 30, p-value = 6e-09
## alternative hypothesis: true ratio of variances is not equal to 1
## 95 percent confidence interval:
##  0.05 0.21
## sample estimates:
## ratio of variances 
##                0.1</code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="two-sample-t-test.html#cb24-1"></a><span class="co">#Levene&#39;s test (same as SAS output)</span></span>
<span id="cb24-2"><a href="two-sample-t-test.html#cb24-2"></a>car<span class="op">::</span><span class="kw">leveneTest</span>(offer <span class="op">~</span><span class="st"> </span>group, </span>
<span id="cb24-3"><a href="two-sample-t-test.html#cb24-3"></a>       <span class="dt">data =</span> tickets)</span></code></pre></div>
<pre><code>## Levene&#39;s Test for Homogeneity of Variance (center = median)
##       Df F value  Pr(&gt;F)    
## group  1    16.4 0.00014 ***
##       62                    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="two-sample-t-test.html#cb26-1"></a><span class="kw">t.test</span>(<span class="dt">formula =</span> offer <span class="op">~</span><span class="st"> </span>group, </span>
<span id="cb26-2"><a href="two-sample-t-test.html#cb26-2"></a>       <span class="dt">data =</span> tickets, </span>
<span id="cb26-3"><a href="two-sample-t-test.html#cb26-3"></a>       <span class="dt">alternative =</span> <span class="st">&quot;less&quot;</span>)</span></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  offer by group
## t = -3, df = 36, p-value = 0.0009
## alternative hypothesis: true difference in means is less than 0
## 95 percent confidence interval:
##  -Inf -7.5
## sample estimates:
##   mean in group cash mean in group credit 
##                   57                   72</code></pre>
<p>It now remains to check the normality assumption graphically; <strong>SAS</strong> prints histograms with superimposed densities and box-and-whiskers plots. We can also add quantile-quantile plots; the basic function is <code>qqnorm</code> in <strong>R</strong> and <code>qqline</code> adds a line passing through the first and third quartile, but we use the <code>qqPlot</code> function from the <code>car</code> package instead, since the latter includes a grid in the background and simulated approximate 95% pointwise confidence intervals. The discreteness of the observations in the cash group is visible (corresponding to horizontal segments). Here, due to large enough sample sizes, we have no evidence against normality even if the variances are obviously different.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="two-sample-t-test.html#cb28-1"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">1</span>)) <span class="co">#change margins,</span></span>
<span id="cb28-2"><a href="two-sample-t-test.html#cb28-2"></a><span class="co"># mfrow = c(1,2) gives two plots side by side</span></span>
<span id="cb28-3"><a href="two-sample-t-test.html#cb28-3"></a><span class="kw">boxplot</span>(offer <span class="op">~</span><span class="st"> </span>group, <span class="dt">data =</span> tickets, </span>
<span id="cb28-4"><a href="two-sample-t-test.html#cb28-4"></a>        <span class="dt">main =</span> <span class="st">&quot;Box-and-whiskers plot&quot;</span>, </span>
<span id="cb28-5"><a href="two-sample-t-test.html#cb28-5"></a>        <span class="dt">ylab =</span> <span class="st">&quot;Amount offered (in dollars)&quot;</span>,</span>
<span id="cb28-6"><a href="two-sample-t-test.html#cb28-6"></a>        <span class="dt">frame =</span> <span class="ot">FALSE</span>)</span>
<span id="cb28-7"><a href="two-sample-t-test.html#cb28-7"></a></span>
<span id="cb28-8"><a href="two-sample-t-test.html#cb28-8"></a><span class="co"># Histogram </span></span>
<span id="cb28-9"><a href="two-sample-t-test.html#cb28-9"></a><span class="co"># Attach dataset - variables (columns) are now visible</span></span>
<span id="cb28-10"><a href="two-sample-t-test.html#cb28-10"></a><span class="co"># avoids having tickets$group everywhere, now group</span></span>
<span id="cb28-11"><a href="two-sample-t-test.html#cb28-11"></a><span class="kw">attach</span>(tickets)</span>
<span id="cb28-12"><a href="two-sample-t-test.html#cb28-12"></a><span class="kw">hist</span>(<span class="dt">x =</span> offer[group <span class="op">==</span><span class="st"> &quot;cash&quot;</span>], </span>
<span id="cb28-13"><a href="two-sample-t-test.html#cb28-13"></a>     <span class="dt">breaks =</span> <span class="dv">10</span>,</span>
<span id="cb28-14"><a href="two-sample-t-test.html#cb28-14"></a>     <span class="dt">xlim =</span> <span class="kw">range</span>(offer),</span>
<span id="cb28-15"><a href="two-sample-t-test.html#cb28-15"></a>     <span class="dt">freq =</span> <span class="ot">FALSE</span>, <span class="co"># density scale</span></span>
<span id="cb28-16"><a href="two-sample-t-test.html#cb28-16"></a>     <span class="dt">xlab =</span> <span class="st">&quot;Amount offered (in dollars)&quot;</span>,</span>
<span id="cb28-17"><a href="two-sample-t-test.html#cb28-17"></a>     <span class="dt">main =</span> <span class="st">&quot;Histogram&quot;</span>,</span>
<span id="cb28-18"><a href="two-sample-t-test.html#cb28-18"></a>     <span class="dt">col =</span> <span class="kw">rgb</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.5</span>))</span>
<span id="cb28-19"><a href="two-sample-t-test.html#cb28-19"></a><span class="co">#Add the second group to the plot</span></span>
<span id="cb28-20"><a href="two-sample-t-test.html#cb28-20"></a><span class="kw">hist</span>(<span class="dt">x =</span> offer[group <span class="op">==</span><span class="st"> &quot;credit&quot;</span>], </span>
<span id="cb28-21"><a href="two-sample-t-test.html#cb28-21"></a>     <span class="dt">breaks =</span> <span class="dv">10</span>,</span>
<span id="cb28-22"><a href="two-sample-t-test.html#cb28-22"></a>     <span class="dt">add =</span> <span class="ot">TRUE</span>,</span>
<span id="cb28-23"><a href="two-sample-t-test.html#cb28-23"></a>     <span class="dt">freq =</span> <span class="ot">FALSE</span>,</span>
<span id="cb28-24"><a href="two-sample-t-test.html#cb28-24"></a>     <span class="dt">col =</span> <span class="kw">rgb</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.5</span>))</span>
<span id="cb28-25"><a href="two-sample-t-test.html#cb28-25"></a><span class="kw">legend</span>(<span class="dt">x =</span> <span class="st">&quot;topright&quot;</span>, </span>
<span id="cb28-26"><a href="two-sample-t-test.html#cb28-26"></a>       <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>), </span>
<span id="cb28-27"><a href="two-sample-t-test.html#cb28-27"></a>       <span class="dt">legend =</span> <span class="kw">c</span>(<span class="st">&quot;cash&quot;</span>, <span class="st">&quot;credit&quot;</span>), </span>
<span id="cb28-28"><a href="two-sample-t-test.html#cb28-28"></a>       <span class="dt">bty =</span> <span class="st">&quot;n&quot;</span>,</span>
<span id="cb28-29"><a href="two-sample-t-test.html#cb28-29"></a>       <span class="dt">lwd =</span> <span class="dv">5</span>)</span>
<span id="cb28-30"><a href="two-sample-t-test.html#cb28-30"></a><span class="co">#superimpose density lines</span></span>
<span id="cb28-31"><a href="two-sample-t-test.html#cb28-31"></a><span class="kw">lines</span>(<span class="kw">density</span>(offer[group <span class="op">==</span><span class="st"> &quot;cash&quot;</span>]), </span>
<span id="cb28-32"><a href="two-sample-t-test.html#cb28-32"></a>      <span class="dt">lty =</span> <span class="dv">2</span>,</span>
<span id="cb28-33"><a href="two-sample-t-test.html#cb28-33"></a>      <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb28-34"><a href="two-sample-t-test.html#cb28-34"></a><span class="kw">lines</span>(<span class="kw">density</span>(offer[group <span class="op">==</span><span class="st"> &quot;credit&quot;</span>]), </span>
<span id="cb28-35"><a href="two-sample-t-test.html#cb28-35"></a>      <span class="dt">lty =</span> <span class="dv">2</span>,</span>
<span id="cb28-36"><a href="two-sample-t-test.html#cb28-36"></a>      <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb28-37"><a href="two-sample-t-test.html#cb28-37"></a><span class="co"># Add normal density lines</span></span>
<span id="cb28-38"><a href="two-sample-t-test.html#cb28-38"></a><span class="kw">lines</span>(<span class="kw">curve</span>(<span class="kw">dnorm</span>(x,</span>
<span id="cb28-39"><a href="two-sample-t-test.html#cb28-39"></a>            <span class="dt">mean =</span> <span class="kw">mean</span>(offer[group <span class="op">==</span><span class="st"> &quot;cash&quot;</span>]),</span>
<span id="cb28-40"><a href="two-sample-t-test.html#cb28-40"></a>            <span class="dt">sd =</span> <span class="kw">sd</span>(offer[group <span class="op">==</span><span class="st"> &quot;cash&quot;</span>])), </span>
<span id="cb28-41"><a href="two-sample-t-test.html#cb28-41"></a>            <span class="dt">from =</span> <span class="dv">30</span>, </span>
<span id="cb28-42"><a href="two-sample-t-test.html#cb28-42"></a>            <span class="dt">to =</span> <span class="dv">150</span>,</span>
<span id="cb28-43"><a href="two-sample-t-test.html#cb28-43"></a>            <span class="dt">add =</span> <span class="ot">TRUE</span>),</span>
<span id="cb28-44"><a href="two-sample-t-test.html#cb28-44"></a>      <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb28-45"><a href="two-sample-t-test.html#cb28-45"></a><span class="kw">lines</span>(<span class="kw">curve</span>(<span class="kw">dnorm</span>(x,</span>
<span id="cb28-46"><a href="two-sample-t-test.html#cb28-46"></a>            <span class="dt">mean =</span> <span class="kw">mean</span>(offer[group <span class="op">==</span><span class="st"> &quot;credit&quot;</span>]),</span>
<span id="cb28-47"><a href="two-sample-t-test.html#cb28-47"></a>            <span class="dt">sd =</span> <span class="kw">sd</span>(offer[group <span class="op">==</span><span class="st"> &quot;credit&quot;</span>])), </span>
<span id="cb28-48"><a href="two-sample-t-test.html#cb28-48"></a>            <span class="dt">from =</span> <span class="dv">30</span>, </span>
<span id="cb28-49"><a href="two-sample-t-test.html#cb28-49"></a>            <span class="dt">to =</span> <span class="dv">150</span>,</span>
<span id="cb28-50"><a href="two-sample-t-test.html#cb28-50"></a>            <span class="dt">add =</span> <span class="ot">TRUE</span>),</span>
<span id="cb28-51"><a href="two-sample-t-test.html#cb28-51"></a>      <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<p><img src="Statistical-modelling_files/figure-html/plottickets-1.png" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="two-sample-t-test.html#cb29-1"></a><span class="co"># Quantile-quantile plots</span></span>
<span id="cb29-2"><a href="two-sample-t-test.html#cb29-2"></a><span class="co"># install `car` package (only once)</span></span>
<span id="cb29-3"><a href="two-sample-t-test.html#cb29-3"></a><span class="co"># uncomment following line to install</span></span>
<span id="cb29-4"><a href="two-sample-t-test.html#cb29-4"></a><span class="co"># install.packages(&quot;car&quot;)</span></span>
<span id="cb29-5"><a href="two-sample-t-test.html#cb29-5"></a><span class="co"># default function is `qqnorm</span></span>
<span id="cb29-6"><a href="two-sample-t-test.html#cb29-6"></a>car<span class="op">::</span><span class="kw">qqPlot</span>(offer[group <span class="op">==</span><span class="st"> &quot;cash&quot;</span>],</span>
<span id="cb29-7"><a href="two-sample-t-test.html#cb29-7"></a>            <span class="dt">ylab =</span> <span class="st">&quot;observed quantiles (cash)&quot;</span>)</span></code></pre></div>
<pre><code>## [1] 32  8</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="two-sample-t-test.html#cb31-1"></a>car<span class="op">::</span><span class="kw">qqPlot</span>(offer[group <span class="op">==</span><span class="st"> &quot;credit&quot;</span>],</span>
<span id="cb31-2"><a href="two-sample-t-test.html#cb31-2"></a>            <span class="dt">ylab =</span> <span class="st">&quot;observed quantiles (credit)&quot;</span>)</span></code></pre></div>
<p><img src="Statistical-modelling_files/figure-html/plottickets-2.png" width="70%" style="display: block; margin: auto;" /></p>
<pre><code>## [1] 14  5</code></pre>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="two-sample-t-test.html#cb33-1"></a><span class="co"># alternatively</span></span>
<span id="cb33-2"><a href="two-sample-t-test.html#cb33-2"></a><span class="co"># qqnorm(offer[group==&quot;cash&quot;], main = &quot;cash&quot;)</span></span>
<span id="cb33-3"><a href="two-sample-t-test.html#cb33-3"></a><span class="co"># qqline(offer[group==&quot;cash&quot;])</span></span>
<span id="cb33-4"><a href="two-sample-t-test.html#cb33-4"></a><span class="co"># Detach dataset (don&#39;t forget)</span></span>
<span id="cb33-5"><a href="two-sample-t-test.html#cb33-5"></a><span class="kw">detach</span>(tickets)</span></code></pre></div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="one-sample-and-paired-t-test.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="wilcoxon-rank-sum-test.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Statistical modelling.pdf", "Statistical modelling.epub"],
"toc": {
"collapse": "none"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
